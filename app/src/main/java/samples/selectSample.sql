
-- 특정 EMP_PK의 값으로 근태 전체 조회
SELECT *
FROM ATTENDANCE
WHERE EMPLOYEE_PK = 'emp_01'
ORDER BY DATE;

-- ATTENDANCE테이블의 DATE별로
-- EMPLOYEE_PK
-- EMP_NAME
-- DEPARTMENT_PK
-- STATUS_PK
-- 조회하는 쿼리

SELECT
    a.DATE,
    e.EMPLOYEE_PK,
    e.EMP_NAME,
    ed.DEPARTMENT_PK,
    a.STATUS_PK
FROM
    ATTENDANCE a
        JOIN
    EMPLOYEE e ON a.EMPLOYEE_PK = e.EMPLOYEE_PK
        JOIN
    EMP_DEP ed ON e.EMPLOYEE_PK = ed.EMPLOYEE_PK
        JOIN
    DEPARTMENT d ON ed.DEPARTMENT_PK = d.DEPARTMENT_PK
WHERE
    a.DATE IS NOT NULL
ORDER BY
    a.DATE, e.EMPLOYEE_PK;